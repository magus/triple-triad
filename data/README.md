# data

extract and parse game data, textures and images from ffxiv files

## todo

- compose sprite sheet of transparent card backgrounds (remove card background from rake)
- in our UI we can compose the transparent cards over the correct background to create red/blue cards


## run

```
yarn build
```

## setup `data/game`

- On **FFXIV machine**
  - [Install FFXIV TexTools](https://github.com/TexTools/FFXIV_TexTools_UI)
    - Search for **triad**
    - Select **CardTripleTriad**
    - Toggle **HD Texture**
    - Path to the texture **`ui/uld/cardtripletriad_hr1.tex`** at bottom
    - Copied into `extract-ui-data` script to extract as image
  - [Download the latest version of SaintCoinach.Cmd from the releases page](https://github.com/ufx/SaintCoinach/releases)
    - Unzip the `SaintCoinach.Cmd` archive and navigate into it
    - Copy paste `game/1-extract-ui-data.bat` into the `SaintCoinach` folder
    - Double-click to run `1-extract-ui-data.bat`
    - Open the new game version folder which contains `data.zip`
    - Send `data.zip` to **development machine**
- On **development machine**,
  - Ensure `data.zip` is inside `data/game` folder i.e. `data/game/data.zip`

## data

https://github.com/xivapi/ffxiv-datamining

> **card id and stats**
> ./ffxiv-datamining/csv/TripleTriadCardResident.csv

> **card names by id**
> ./ffxiv-datamining/csv/TripleTriadCard.csv

> **card npcs id map to guaranteed cards etc.**
> ./ffxiv-datamining/csv/TripleTriad.csv
> **lookup npc id by card npc id**
> ./ffxiv-datamining/csv/ENpcBase.csv
> **lookup card npc name by id**
> ./ffxiv-datamining/csv/ENpcResident.csv

> **rules**
> ./ffxiv-dataminingcsv/TripleTriadRule.csv

## spritesheet

generated by https://triad.raelys.com

> https://github.com/mattantonelli/ffxiv-triple-triad/tree/master/lib/tasks/card_images.rake

> **card dimensions**
```
width: 104px
height: 128px
```

horizontal spritesheet is a zero-based array of concatenated card images. this means we index by `x` based on the card `id` to get a specific card image

> **ID 75, Squall Leonhart**

```
(75 - 1) * 104px = 7696px
```

## individual card images

> **ID 75, Squall Leonhart**
```
const imageId = 82100 + id;
`https://xivapi.com/i/082000/0${imageId}.png`
```
> https://xivapi.com/i/082000/082175.png
